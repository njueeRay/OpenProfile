# Astro 5.x è¿ç§»å¯è¡Œæ€§æŠ¥å‘Š

**æ—¥æœŸï¼š** 2026-03-01  
**ä½œè€…ï¼š** Researcher Agent  
**ç›®çš„ï¼š** è¯„ä¼° njueeray.github.ioï¼ˆå½“å‰ Astro 4.16.xï¼‰è¿ç§»è‡³ Astro 5.x çš„å¯è¡Œæ€§ã€å·¥ä½œé‡ä¸æ”¶ç›Š  
**è¾“å‡ºæ ¼å¼ï¼š** ç ”ç©¶æ‘˜è¦ + å†³ç­–å»ºè®®  
**çŠ¶æ€ï¼š** âœ… å®Œæˆï¼Œå»ºè®®å·²æäº¤ Brain

---

## ä¸€ã€Astro 5.x æ ¸å¿ƒå˜æ›´æ¸…å•

### 1.1 é‡å¤§ç ´åæ€§å˜æ›´ï¼ˆBreaking Changesï¼‰

| å˜æ›´é¡¹ | å½±å“é¢ | å½“å‰ä»£ç æ˜¯å¦å—å½±å“ |
|--------|--------|-------------------|
| **Content Collections â†’ Content Layer API** | `src/content/` æ‰€æœ‰é›†åˆ | âš ï¸ ä¸­åº¦å½±å“ |
| `getEntry` / `getCollection` API ä¿æŒå…¼å®¹ | blog + authors é›†åˆ | âœ… æ— å½±å“ |
| `astro:content` é›†åˆå®šä¹‰è¯­æ³•å˜åŒ– | `src/content/config.ts` | âš ï¸ éœ€å°æ”¹ |
| `getEntryBySlug` åºŸå¼ƒ â†’ `getEntry` | blog/[...slug].astro | âœ… å·²ä½¿ç”¨æ–° API |
| **`ViewTransitions` ç§»è‡³ç¨³å®š** | `src/layouts/BaseLayout.astro` | âœ… import è·¯å¾„ä¸å˜ |
| `astro/transitions` å‘½åç©ºé—´è°ƒæ•´ | â€” | âœ… å½“å‰ import å·²å…¼å®¹ |
| **`Astro.glob()` å®Œå…¨åºŸå¼ƒ** | å…¨ç«™ | âœ… æœªä½¿ç”¨ |
| **`@astrojs/image` ç‹¬ç«‹** | â€” | âœ… æœªä½¿ç”¨ |
| **`output: 'server'` é…ç½®è¯­æ³•** | `astro.config.mjs` | âœ… ä½¿ç”¨ staticï¼Œæ— å½±å“ |
| **HTML è½¬ä¹‰è¡Œä¸ºè°ƒæ•´** | MDX å†…å®¹æ¸²æŸ“ | âš ï¸ éœ€éªŒè¯ |
| **`set:html` ç±»å‹å˜æ›´** | `BaseLayout.astro` JSON-LD | âœ… ä»æ”¯æŒï¼Œè¯­ä¹‰ä¸€è‡´ |

### 1.2 æ–°ç‰¹æ€§æ”¶ç›Šè¯„ä¼°

| æ–°ç‰¹æ€§ | æ”¶ç›Š | å¯¹æœ¬é¡¹ç›®é€‚ç”¨æ€§ |
|--------|------|--------------|
| **Content Layer API** | ç»Ÿä¸€å†…å®¹æ¥æºï¼ˆæœ¬åœ°/è¿œç¨‹/CMSï¼‰ï¼Œç±»å‹å®‰å…¨å¢å¼º | ğŸŸ¡ éƒ¨åˆ†é€‚ç”¨ï¼šåšå®¢ä»çº¯æœ¬åœ°ï¼Œæ”¶ç›Šæœ‰é™ |
| **`@astrojs/svelte` v3 / React 19** | æ–°æ¡†æ¶æ”¯æŒ | âŒ æœ¬é¡¹ç›®çº¯ Astroï¼Œæ— æ¡†æ¶ä¾èµ– |
| **Server Islandsï¼ˆç¨³å®šï¼‰** | é€‰æ‹©æ€§æœåŠ¡ç«¯æ¸²æŸ“ | âŒ çº¯é™æ€ç«™ç‚¹ï¼Œæ— éœ€æ­¤ç‰¹æ€§ |
| **`experimental.fonts`** | åŸç”Ÿå­—ä½“ä¼˜åŒ– | ğŸŸ¡ å¯ç”¨äº CJK å­—ä½“åŠ è½½ä¼˜åŒ– |
| **æ„å»ºæ€§èƒ½æå‡ ~25%** | å†·æ„å»ºåŠ é€Ÿ | âœ… é€‚ç”¨ï¼Œ16 ç¯‡ MDX ç›®å‰æœ‰æ„Ÿ |
| **Vite 6 é›†æˆ** | HMR æ›´å¿«ã€å†…å­˜æ›´ä½ | âœ… å¼€å‘ä½“éªŒæ”¹å–„ |
| **`pagefind` åŸç”Ÿé›†æˆ** | å½“å‰æ‰‹åŠ¨ `postbuild` è¿è¡Œ | âœ… å¯ç®€åŒ– `package.json` |

### 1.3 ä¾èµ–å…¼å®¹æ€§çŸ©é˜µ

| ä¾èµ– | å½“å‰ç‰ˆæœ¬ | Astro 5 å…¼å®¹æ€§ | æ“ä½œ |
|------|----------|--------------|------|
| `@astrojs/mdx` | `^3.1.9` | âš ï¸ éœ€å‡è‡³ `^4.x` | åŒæ­¥å‡çº§ |
| `@astrojs/sitemap` | `^3.2.1` | âœ… å…¼å®¹ | æ— éœ€æ”¹åŠ¨ |
| `@astrojs/rss` | `^4.0.15` | âœ… å…¼å®¹ | æ— éœ€æ”¹åŠ¨ |
| `@astrojs/check` | `^0.9.4` | âš ï¸ éœ€å‡è‡³ `^0.10.x` | åŒæ­¥å‡çº§ |
| `pagefind` | `^1.4.0` | âœ… å…¼å®¹ | æ— éœ€æ”¹åŠ¨ |
| `typescript` | `^5.7.3` | âœ… å…¼å®¹ | æ— éœ€æ”¹åŠ¨ |

---

## äºŒã€è¿ç§»å·¥ä½œé‡è¯„ä¼°

### 2.1 å¿…é¡»æ”¹åŠ¨ï¼ˆMust-fixï¼‰

```
src/content/config.ts          â€” Content Layer é€‚é…ï¼ˆé¢„è®¡ 30 minï¼‰
                                  defineCollection({ loader: glob({...}) })
package.json                   â€” å‡çº§ astro + @astrojs/mdx + @astrojs/check
.github/workflows/deploy.yml   â€” node-version æ£€æŸ¥ï¼ˆå½“å‰ 22ï¼ŒAstro 5 æ¨è 18+ï¼Œå…¼å®¹ï¼‰
```

**åˆè®¡ï¼šçº¦ 2-3 å°æ—¶ï¼ˆåŒ…å«æµ‹è¯•éªŒè¯ï¼‰**

### 2.2 å¯é€‰ä¼˜åŒ–ï¼ˆNice-to-haveï¼‰

```
astro.config.mjs               â€” å¯ç”¨ experimental.fontsï¼ˆCJK å­—ä½“ä¼˜åŒ–ï¼‰
package.json                   â€” ç§»é™¤ postbuild pagefindï¼ˆæ”¹ç”¨å†…ç½®ï¼‰
src/pages/blog/[...slug].astro â€” Schema ç±»å‹æ³¨è§£æ›´æ–°ï¼ˆå¯é€‰ï¼‰
```

**åˆè®¡ï¼šçº¦ 1 å°æ—¶ï¼ˆå¯å•ç‹¬ PRï¼‰**

### 2.3 é¢„ä¼°é£é™©

| é£é™© | æ¦‚ç‡ | å½±å“ | ç¼“è§£ç­–ç•¥ |
|------|------|------|---------|
| MDX æ¸²æŸ“è¡Œä¸ºç»†å¾®å·®å¼‚ | ä½ | ä½ | å…¨ç«™æ„å»ºé¢„è§ˆéªŒè¯ |
| Content Layer è¿ç§»åé›†åˆæŸ¥è¯¢æœ‰å˜åŒ– | ä¸­ | ä¸­ | ä¿ç•™ `getCollection` è°ƒç”¨ï¼Œä»…æ”¹å®šä¹‰ |
| `@astrojs/mdx@4` ç ´åè¯­æ³• | ä½ | ä¸­ | æµ‹è¯•æ‰€æœ‰ `.mdx` æ–‡ç« æ¸²æŸ“ |
| æ„å»ºäº§ç‰©è·¯å¾„å˜åŒ– | ä½ | é«˜ | éªŒè¯ `dist/` ç»“æ„ï¼Œæ›´æ–° pagefind é…ç½® |

---

## ä¸‰ã€ç»“è®ºä¸å»ºè®®

### 3.1 è¿ç§»å¯è¡Œæ€§ï¼šâœ… å¯è¡Œï¼Œå»ºè®®çº³å…¥ v5.0.0

**ç†ç”±ï¼š**
1. **å·¥ä½œé‡å¯æ§**ï¼šæ ¸å¿ƒè¿ç§» 2-3 å°æ—¶ï¼Œæ€»ä½“çº¦åŠå¤©å·¥ä½œé‡
2. **é£é™©ä½**ï¼šæœ¬é¡¹ç›®ä¸ºçº¯é™æ€ï¼Œæœªä½¿ç”¨ Server Islands / React / Image ç­‰é«˜å˜æ›´åŒºåŸŸ
3. **æ˜æ˜¾æ”¶ç›Š**ï¼šæ„å»ºé€Ÿåº¦æå‡ ~25% + Vite 6 å¼€å‘ä½“éªŒ + ç±»å‹å®‰å…¨å¢å¼º

### 3.2 æ¨èè¿ç§»æ—¶æœº

```
å½“å‰çŠ¶æ€ï¼šAstro 4.16.x â€” ç¨³å®šï¼ŒåŠŸèƒ½å®Œæ•´
è¿ç§»è§¦å‘æ¡ä»¶ï¼ˆæ»¡è¶³ä»»ä¸€å³å¯æ¨è¿›ï¼‰ï¼š
  âœ“ åšå®¢æ–‡ç« æ•°è¾¾åˆ° 30+ ç¯‡ï¼ˆå¤åˆ©äºæ„å»ºåŠ é€Ÿï¼‰
  âœ“ éœ€è¦é›†æˆ Server Islands æˆ–è¿œç¨‹å†…å®¹æº
  âœ“ Astro 5 çš„ LTS ç‰ˆæœ¬å‘å¸ƒï¼ˆé¢„è®¡ 2026 Q2ï¼‰
```

### 3.3 è¿ç§»è·¯å¾„å»ºè®®

```bash
# 1. æ–°å»º feature/astro-v5-migration worktree
git worktree add -b feature/astro-v5-migration ..\njueeRay-v5 main

# 2. å‡çº§æ ¸å¿ƒä¾èµ–
npm install astro@5 @astrojs/mdx@4 @astrojs/check@0.10

# 3. è¿è¡Œè¿ç§»å‘å¯¼ï¼ˆAstro 5 æä¾›ï¼‰
npx astro@5 migrate

# 4. æ‰‹åŠ¨é€‚é… content/config.ts Content Layer è¯­æ³•

# 5. å…¨é‡æ„å»ºéªŒè¯ + è§†è§‰å›å½’æµ‹è¯•

# 6. PR ä¸Šçº¿
```

---

## å››ã€å‚è€ƒèµ„æº

- [Astro 5.0 Migration Guide](https://docs.astro.build/en/guides/upgrade-to/v5/)
- [Content Layer API RFC](https://github.com/withastro/roadmap/discussions/831)
- [Astro 5.0 Release Notes](https://astro.build/blog/astro-5/)
- [Vite 6 Migration Guide](https://vitejs.dev/guide/migration.html)

---

*æŠ¥å‘Šç”± Researcher Agent æ’°å†™ï¼Œä¾› Brain å†³ç­–ä½¿ç”¨ã€‚æ›´æ–°å‘¨æœŸï¼šAstro 5.x minor ç‰ˆæœ¬å‘å¸ƒæ—¶å¤å®¡ã€‚*
