# V4.0 全体规划会议纪要

**日期：** 2026-02-26  
**参与者：** brain · pm · dev · researcher · code-reviewer  
**会议模式：** 全体同步会议  
**触发来源：** v3.0.0 正式发布 + PM 提出两项核心架构理念  
**状态：** ✅ 决议已形成，待执行

---

## 零、背景

v3.0.0 于今日（2026-02-26）正式发布（tag: `v3.0.0`，GitHub Release 已创建）。  
三条开发主线全部交付：SEO 地基（Phase X）、Blog 标签系统（Phase Y）、Profile 新组件（Phase Z）。Playbook 完成可移植化重构。

**PM 在发布后提出两项影响深远的架构理念，触发本次全体会议。**

---

## 一、PM 理念输入（原文记录）

> **理念 A — 独立版本体系**
> Playbook 的版本应该是自主维护的，包括它底下的 Agent 的版本也应该是内部独立维护的，区分于项目版本。
> 这样才能确保能够追溯，能够独立维护这个团队的能力。

> **理念 B — 通用启动套件**
> 不管原有团队的能力和结构怎么样，只要拿到这本 Playbook 就能够去快速调整状态，
> 组建和招募所需的团队成员，来最大化地推进新的项目。

---

## 二、理念 A 深度讨论：独立版本体系

### Brain 分析

当前版本体系存在严重的**语义混用**：Playbook `v3.0.0` 和 项目 `v3.0.0` 是同一个 tag，无法分辨"是产品功能升级还是团队能力升级"。

这不符合 PM 理念 A 的追溯要求。必须将 **Playbook + Agent 版本体系** 从项目 semver 中完全独立出来。

### PM 确认方向

完全同意 Brain 的判断。分离势在必行。

### Dev 技术方案（拟议）

提出三层独立版本体系：

| 层级 | 名称 | 版本格式 | 当前值 | 维护位置 |
|------|------|----------|--------|----------|
| L1 | **项目版本** | `vMAJOR.MINOR.PATCH`（semver） | `v3.0.0` | `CHANGELOG.md` + GitHub Tag |
| L2 | **Playbook 版本** | `Playbook vPB_MAJOR.PB_MINOR` | `Playbook v1.0`（待初始化） | `docs/team-playbook.md` 头部 + `PLAYBOOK-CHANGELOG.md` |
| L3 | **Agent 版本** | `vAGENT_MAJOR.AGENT_MINOR` | 各 Agent 独立（待初始化） | 各 Agent 文件头部注释 |

**版本独立规则：**
- 项目功能迭代 → 只升 L1
- Playbook 章节新增/修改 → 只升 L2
- Agent 能力升级/质量门禁调整 → 只升 L3
- 三者可以同时升级，但互不依赖

### Researcher 补充

历史上 `§15 GitHub API 操作规范` 是在 v3.0.0 里加入 Playbook 的，但从 L2 视角这应当是 `Playbook v1.1`。分离后可以精确追踪"团队能力在什么时候提升了什么"，这对未来将 OpenProfile 作为公开方法论参考非常重要。

### Code-Reviewer 质量要求

- [ ] `Playbook vX.Y` 版本号必须在 `team-playbook.md` 首行可见
- [ ] 每个 Agent 文件头部必须包含 `Agent版本: vX.Y` 字段
- [ ] 新建 `PLAYBOOK-CHANGELOG.md` 记录独立变更历史
- [ ] `copilot-instructions.md` 须同时显示：项目版本 + Playbook 版本 + 各 Agent 版本

### 决议 A

> **通过。** v4.0 第一优先级任务。执行方案采用 Dev 拟议的三层独立版本体系。

---

## 三、理念 B 深度讨论：通用启动套件

### Brain 分析

理念 B 是理念 A 的延伸用例：使用者拿到 Playbook 时，应当能做到：

1. 读完 §1（使用前提）→ 判断自身情况是否适用
2. 读完 §17（定制指南）→ 按 5 步流程完成冷启动
3. 按 §13（团队自主进化）→ 招募 / 改造 / 停用 Agent
4. 拿到所有 Agent 文件头部的版本和职能描述 → 即刻知道团队当前状态

但目前 §17 的冷启动协议还不够具体，**缺少"评估现有团队状态 → 决定保留/替换/新增"的决策树**。

### Researcher 调研建议

现有开源 AI Workflow 框架（CrewAI / AutoGen）的 Agent 卡片格式有参考价值，建议在 §13 或 §17 中引入"Agent 能力快照卡"（一张 Markdown 表，含：职能 / 版本 / 核心能力 / 依赖工具 / 已知局限），便于新接手者秒读当前团队状态。

### PM 确认

认可"Agent 能力快照卡"方向。这个卡片应当在 `copilot-instructions.md` 中常驻，作为团队对外展示的"门面"。新接手者第一时间看到的就是这张卡片，而不是阅读几百行的 Playbook。

### Dev 实现方向

- 在 `copilot-instructions.md` 新增 `## 团队能力快照` 模块（Agent 卡片表格）
- 在 Playbook §13 扩充"招募决策树"：判断条件（任务需求 vs. 当前 Agent 能力矩阵）
- 在 Playbook §17 扩充冷启动协议 Step 3：**评估快照 → 缺口识别 → 招募优先级**

### 决议 B

> **通过。** 作为 v4.0 Playbook 升级的核心主题，代号 **"Playbook v2.0"（L2 版本）**。

---

## 四、v4.0 开发计划

### 4.1 版本目标

> **v4.0 主题：团队能力独立化 + 站点体验深化**
> - L1（项目）版本：`v4.0.0`
> - L2（Playbook）版本：`Playbook v2.0`（含决策树 + Agent 快照卡 + 独立 CHANGELOG）
> - L3（Agent）版本：各 Agent 初始化为 `v1.0`（此前无正式版本号）

### 4.2 执行 Phase 划分

#### Phase V — 版本体系独立化（高优先级，优先执行）

| 编号 | 任务 | Agent | 说明 |
|------|------|-------|------|
| V-1 | 新增 `PLAYBOOK-CHANGELOG.md` | dev | 记录 Playbook L2 独立变更历史，初始条目追溯至 v1.0 |
| V-2 | `team-playbook.md` 头部添加版本号 `Playbook v2.0` | dev | 格式参考 §1 或文件最顶部 |
| V-3 | 各 Agent 文件头部添加 `Agent版本:` 字段 | dev | brain/pm/dev/researcher/code-reviewer 各自初始化为 `v1.0` |
| V-4 | `copilot-instructions.md` 新增 `## 团队能力快照` 模块 | dev | 含 Agent 卡片表（职能/版本/核心能力/已知局限）|
| V-5 | Playbook §13 扩充招募决策树 | dev | 任务需求 vs. Agent 矩阵 → 缺口识别 → 招募优先级 |
| V-6 | Playbook §17 冷启动协议扩充 Step 3 | dev | 评估快照 → 缺口识别 → 招募 SOP |
| V-7 | `CHANGELOG.md` 补充 L2/L3 变更记录格式规范 | dev | 区分 `[Project]` / `[Playbook]` / `[Agent]` 前缀 |

#### Phase W — Astro 站点体验深化

| 编号 | 任务 | Agent | 优先级 | 说明 |
|------|------|-------|--------|------|
| W-1 | 全文搜索 | dev | P1 | Pagefind（静态搜索，零服务端依赖）|
| W-2 | 暗色/亮色手动切换 | dev | P1 | 持久化到 localStorage，与系统偏好兼容 |
| W-3 | 文章阅读进度条 | dev | P2 | 顶部细线进度条 |
| W-4 | Blog 目录（TOC） | dev | P2 | 文章右侧固定目录，锚点跳转 |
| W-5 | 评论系统 | dev | P2 | Giscus（GitHub Discussions 驱动，零数据库）|
| W-6 | 首页新 Project 卡片 | dev | P3 | 替换 / 新增展示项目 |
| W-7 | Open Graph 预览图自动生成 | dev | P3 | 每篇文章自动生成 `og:image`（`@vercel/og` 或静态模板）|

#### Phase P — Profile README 深化

| 编号 | 任务 | Agent | 优先级 | 说明 |
|------|------|-------|--------|------|
| P-1 | Blog 最新文章自动同步 | dev | P2 | GitHub Action 读 RSS → 更新 README Featured 区块 |
| P-2 | WakaTime 周报徽章 | dev | P3 | 取代当前的 waka-readme-stats（可靠性更好）|

### 4.3 量化目标（P-指标）

| 编号 | 目标 | 验收标准 |
|------|------|---------|
| P-1 | Playbook 独立版本落地 | `PLAYBOOK-CHANGELOG.md` 创建；`team-playbook.md` 头部含版本号 |
| P-2 | Agent 版本落地 | 5 个 Agent 文件均含 `Agent版本:` 字段 |
| P-3 | 团队快照卡 | `copilot-instructions.md` 含 `## 团队能力快照` 模块 |
| P-4 | 全文搜索 | Pagefind 集成，搜索结果 ≤200ms（本地测试）|
| P-5 | 暗/亮切换 | 手动切换 + localStorage 持久化 + 系统偏好跟随 |
| P-6 | 版本 DoD | L1/L2/L3 所有版本号在 `copilot-instructions.md` 同步显示 |

### 4.4 质量门禁

| # | 门禁 | 验收标准 |
|---|------|---------|
| QG-1 | 三层版本一致性 | `copilot-instructions.md` 中显示的版本 = 实际文件头部版本 |
| QG-2 | Playbook CHANGELOG 完整性 | `PLAYBOOK-CHANGELOG.md` 追溯至 `Playbook v1.0` |
| QG-3 | Agent 快照卡完整性 | 5 个 Agent 全部列入快照卡，无遗漏字段 |
| QG-4 | 搜索可用性 | 构建后搜索索引存在且至少 10 条结果可检索 |
| QG-5 | 主题切换无闪烁 | 页面刷新不出现 FOUC（未应用主题的闪白）|
| QG-6 | code-reviewer APPROVED | 所有 Phase 完成后经 code-reviewer 全面审查 |

---

## 五、Playbook v2.0 要点（L2 层）

本次 Playbook 升级的核心变化：

| 章节 | 变更类型 | 摘要 |
|------|----------|------|
| **§13 团队自主进化** | 扩充 | 新增"招募决策树"：任务缺口 → Agent 矩阵比对 → 招募优先级 SOP |
| **§17 Playbook 定制指南** | 扩充 | 冷启动 Step 3 扩充：读快照 → 识缺口 → 招募流程闭环 |
| **§18 版本体系规范（NEW）** | 新增 | L1/L2/L3 版本定义 + 升级触发条件 + 文件维护位置 + 版本号命名规范 |
| **附录 C Agent 能力快照格式（NEW）** | 新增 | Agent 卡片标准结构 + 示例 + 维护周期说明 |

---

## 六、开发顺序建议

```
Phase V（版本体系独立化）
  → 必须先行，为 v4.0 所有后续变更提供记录框架

Phase W（Astro 体验深化）  +  Phase P（Profile 深化）
  → 并行执行，互不依赖

全部完成 → code-reviewer 审查 → v4.0.0 发布
```

---

## 七、用户操作清单

| # | 操作 | 时机 |
|---|------|------|
| U-1 | 确认 Phase W 各功能的优先级（P1/P2/P3 可调整） | Phase V 完成后 |
| U-2 | 确认 Pagefind 搜索 UI 样式方向 | W-1 实施前 |
| U-3 | 确认是否启用评论系统（Giscus 需要绑定 GitHub Discussions repo） | W-5 实施前 |
| U-4 | 审阅 `团队能力快照` 模块草案 | V-4 完成时 |

---

## 八、遗留议题

| 议题 | 处理方式 |
|------|---------|
| `create-release.ps1` 临时文件 | 已删除（会议前已 clean up） |
| Lighthouse SEO 评分 | v4.0 首批 CI 任务，集成到 GitHub Actions（`treosh/lighthouse-ci-action`）|
| Astro 版本升级（4.x → 5.x） | 纳入 v4.x 研究项；先完成 v4.0 功能，再评估升级风险 |
| OpenProfile 独立 Playbook 仓库 | 长期议题，暂不推进；先在 OpenProfile 内验证 Playbook v2.0 |

---

*会议结束。Phase V 优先启动。等待 PM（用户）确认后执行。*
